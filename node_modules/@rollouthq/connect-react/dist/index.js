var Jr=Object.create;var eo=Object.defineProperty,Gr=Object.defineProperties,tn=Object.getOwnPropertyDescriptor,on=Object.getOwnPropertyDescriptors,en=Object.getOwnPropertyNames,xo=Object.getOwnPropertySymbols,rn=Object.getPrototypeOf,Yo=Object.prototype.hasOwnProperty,Ce=Object.prototype.propertyIsEnumerable;var _e=(o,t,r)=>t in o?eo(o,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[t]=r,f=(o,t)=>{for(var r in t||(t={}))Yo.call(t,r)&&_e(o,r,t[r]);if(xo)for(var r of xo(t))Ce.call(t,r)&&_e(o,r,t[r]);return o},x=(o,t)=>Gr(o,on(t));var _o=(o,t)=>{var r={};for(var n in o)Yo.call(o,n)&&t.indexOf(n)<0&&(r[n]=o[n]);if(o!=null&&xo)for(var n of xo(o))t.indexOf(n)<0&&Ce.call(o,n)&&(r[n]=o[n]);return r};var Ho=(o,t)=>{for(var r in t)eo(o,r,{get:t[r],enumerable:!0})},Ae=(o,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let e of en(t))!Yo.call(o,e)&&e!==r&&eo(o,e,{get:()=>t[e],enumerable:!(n=tn(t,e))||n.enumerable});return o};var C=(o,t,r)=>(r=o!=null?Jr(rn(o)):{},Ae(t||!o||!o.__esModule?eo(r,"default",{value:o,enumerable:!0}):r,o)),nn=o=>Ae(eo({},"__esModule",{value:!0}),o);var En={};Ho(En,{AutomationCreator:()=>No,AutomationEditor:()=>Bo,AutomationsManager:()=>Er,BlueprintActivator:()=>Lo,BlueprintsList:()=>Qo,BlueprintsManager:()=>jr,MyAutomations:()=>$o,MyBlueprints:()=>jo,PoweredByRollout:()=>Vr,RolloutConnectProvider:()=>Yr,components:()=>ye,curlyTemplate:()=>Xr.curlyTemplate,defaultTheme:()=>Bn});module.exports=nn(En);var ye={};Ho(ye,{AutomationCreator:()=>No,AutomationEditor:()=>Bo,AutomationsManager:()=>Er,BlueprintActivator:()=>Lo,BlueprintsList:()=>Qo,BlueprintsManager:()=>jr,MyAutomations:()=>$o,MyBlueprints:()=>jo,PoweredByRollout:()=>Vr,RolloutConnectProvider:()=>Yr});var fo=C(require("react")),wr=require("@rollouthq/api-client-react");var F=C(require("react")),kr=require("react"),Tr=require("spin-delay"),wo=require("@rollouthq/api-client-react"),se=require("@rollouthq/common");var vo=C(require("react")),Io=require("react"),ro=require("@rollouthq/common");var Bt={};Ho(Bt,{BooleanInput:()=>cn,DropdownInput:()=>un,FindBy:()=>pn,MultiSelectInput:()=>dn,NoInputsComponent:()=>fn,RichTextInput:()=>mn});var z=C(require("react")),Ao=require("@rollouthq/common");var ct=C(require("react"));var he=require("@rollouthq/ui"),[ve,rt]=(0,he.createContext)({name:"AppComponentRenderer"});var Nt=require("ts-object-path"),Fe=require("@rollouthq/common");var Ie=require("ts-object-path"),jt=require("zod");function Pe(o,t){let r=(0,Ie.getPath)(t);return Xo(o,r)}function Xo(o,t){let r=t.slice(1),n=o instanceof jt.ZodOptional?o.unwrap():o;if(n instanceof jt.ZodObject){let e=n.shape[t[0]];return t.length>1?Xo(e,r):e}if(n instanceof jt.ZodRecord){let e=n.valueSchema;return t.length>1?Xo(e,r):e}throw console.error("getByPath: unhandled prop type:",n),new Error("getByPath: unhandled prop type")}function nt(o){var I,N,k;let t=rt(),{inputParams:r,setInputParams:n,importedData:e,credentialId:a,isBlueprintActivation:i}=t,s=(0,Nt.getPath)(o),l=(0,Nt.get)(r,o),u=L=>{let Q=structuredClone(r);(0,Nt.set)(Q,o,L),n(Q)},d="inputParamsSchema"in e?e.inputParamsSchema:(0,Fe.inputDefToZodObject)(e.inputParamDefs),b=Pe(d,o),m=b.isOptional(),p=b.description,c=(I=p==null?void 0:p.label)!=null?I:ln(s),g=(N=p==null?void 0:p.description)!=null?N:"",D=(k=p==null?void 0:p.isCredentialDependent)!=null?k:!1,P=d.safeParse(r),w=D&&a==null&&!i?void 0:an(P,o);return{value:l,setValue:u,isOptional:m,label:c,description:g,isCredentialDependent:D,error:w,path:s}}function an(o,t){let r=(0,Nt.getPath)(t);if(!o.success)return o.error.issues.find(n=>n.path.join(".")===r.join("."))}function ln(o){return o.map(t=>sn(t.toString())).join(" ")}function sn(o){let t=o.replace(/([A-Z\d])/g,r=>` ${r.toLowerCase()}`);return`${t[0].toUpperCase()}${t.slice(1)}`}var Vt=require("@rollouthq/ui");function ft(o){var m;let{bind:t,children:r,description:n,error:e,isRequired:a=!1}=o,{credentialId:i,isBlueprintActivation:s=!1}=rt(),l=nt(t),u=l.isCredentialDependent&&i==null&&!s;if(s&&!l.isCredentialDependent)return null;function d(){return u?ct.default.createElement(Vt.Flex,{css:{alignItems:"center",padding:"8px",backgroundColor:"$surfaceSecondary",borderRadius:"4px",color:"$grayMedium",fontSize:"13px",fontWeight:500}},ct.default.createElement(Vt.UserForm,{css:{marginRight:"6px"}}),"Input provided by user when automation is activated"):r}let b=(m=o.label)!=null?m:"";return ct.default.createElement(Jo,{description:n,error:e,isRequired:a,label:b},d())}function Jo(o){let{label:t,description:r,error:n,isRequired:e,children:a}=o;return ct.default.createElement("div",{className:"rollout-form-control"},t&&ct.default.createElement("div",{className:"rollout-form-control__label"},t,e&&ct.default.createElement("span",{className:"rollout-form-control__required-hint"}," ","(required)")),r&&ct.default.createElement("div",{className:"rollout-form-control__description"},r),ct.default.createElement("div",{className:"rollout-form-control__input","data-error":(0,Vt.dataAttr)(!!n)},a),n&&ct.default.createElement("div",{className:"rollout-form-control__error"},n))}var Se=require("@rollouthq/ui"),[Co,B]=(0,Se.createContext)({name:"Form"});var lt=require("@rollouthq/ui");function un(o){var U,h,j;let{bind:t,dependencies:r,fetchOptions:n,allowOnlyVariables:e,isDisabled:a}=o,i=nt(t),{value:s,setValue:l}=i,u=(U=o.label)!=null?U:i.label,d=(h=o.description)!=null?h:i.description,[b,m]=(0,z.useState)([]),[p,c]=(0,z.useState)(!1),{shouldShowErrors:g}=B(),{variables:D,disabled:P}=rt(),w=a||P||r!=null&&r.every(Boolean)!==!0;(0,z.useEffect)(()=>{async function v(){c(!0);let it=await n();m(it),c(!1)}!e&&!w&&v()},[JSON.stringify(r),e,w]),(0,z.useEffect)(()=>{e&&s&&!(0,Ao.isVariable)(s)&&l(void 0)},[e,s]);let I=D.map(v=>({id:`${Ao.ROLLOUTHQ_VARIABLE_PREFIX}${v.id}`,name:`@${v.label}`})),N=[...I,...b],k=N.find(v=>v.id===s),L=z.default.createElement(lt.ComboBox,{"aria-label":"Variable dropdown",optionKey:"id",isDisabled:w,defaultItems:I,menuTrigger:"focus",selectedOption:k,isLoading:p,inputPlaceholder:o.placeholder||"Select option",onSelectionChange:v=>l(v==null?void 0:v.id)},z.default.createElement(lt.ComboBoxSection,{title:"Variables"},I.map(v=>z.default.createElement(lt.ComboBoxItem,{key:v.id},v.name)))),Q=z.default.createElement(lt.ComboBox,{"aria-label":"Variable dropdown",optionKey:"id",isDisabled:w,defaultItems:N,menuTrigger:"focus",selectedOption:k,key:s,isLoading:p,inputPlaceholder:o.placeholder||"Select option",onSelectionChange:v=>l(v==null?void 0:v.id)},z.default.createElement(lt.ComboBoxSection,{title:"Options"},b.map(v=>z.default.createElement(lt.ComboBoxItem,{key:v.id},v.name))),z.default.createElement(lt.ComboBoxSection,{title:"Variables"},I.map(v=>z.default.createElement(lt.ComboBoxItem,{key:v.id},v.name)))),et=e?L:Q;return z.default.createElement(ft,{bind:t,label:u,description:d,error:g?(j=i.error)==null?void 0:j.message:void 0,isRequired:!i.isOptional},et)}var Ct=C(require("react"));function pn(o){var p,c,g;let{filterInput:t,filterValueInput:r,selectInput:n,resource:e}=o,{bind:a}=o,i=nt(a),{shouldShowErrors:s}=B(),{value:l,setValue:u,isOptional:d}=i,b=(p=o.label)!=null?p:i.label,m=(c=o.description)!=null?c:i.description;return(0,Ct.useEffect)(()=>{l==null&&u("filter")},[l]),Ct.default.createElement(Ct.default.Fragment,null,Ct.default.createElement(ft,{bind:a,label:b,isRequired:!d,description:m,error:s?(g=i.error)==null?void 0:g.message:void 0},Ct.default.createElement("div",{className:"rollout-form-control-find__container"},Ct.default.createElement("button",{type:"button","aria-label":"Search from list button",className:l=="select"?"rollout-form-control-find__active":"rollout-form-control-find__disabled",onClick:()=>u("select")},"From list"),Ct.default.createElement("button",{type:"button","aria-label":"Search by filter button",className:l=="filter"?"rollout-form-control-find__active":"rollout-form-control-find__disabled",onClick:()=>u("filter")},"From search"))),l=="filter"&&t,l=="filter"&&r,l=="select"&&n)}var ho=C(require("react")),De=require("@rollouthq/common");var Ke=require("@rollouthq/ui");function mn(o){var g,D,P,w;let{bind:t,inputProps:r,placeholder:n,disabled:e}=o,a=nt(t),i=(g=o.label)!=null?g:a.label,s=(D=o.description)!=null?D:a.description,{variables:l,disabled:u}=rt(),{shouldShowErrors:d}=B(),b=u||e,m=(P=a.value)!=null?P:null,p=I=>{a.setValue(I!=null?I:void 0)},c=m&&(0,De.resolveMentions)(m,l);return ho.default.createElement(ft,{bind:t,label:i,isRequired:!a.isOptional||o.isRequired,description:s,error:d?(w=a.error)==null?void 0:w.message:void 0},ho.default.createElement("div",{className:"rollout-rich-text-input"},ho.default.createElement(Ke.RichEditor,f({value:c,setValue:p,placeholder:n,formattingEnabled:!1,linksEnabled:!1,mentionVariables:l,isDisabled:b},r))))}var It=C(require("react"));var ke=require("@rollouthq/ui");function dn(o){var P,w,I;let{bind:t,dependencies:r,fetchOptions:n,placeholder:e}=o,a=nt(t),{disabled:i}=rt(),s=i||!(r!=null&&r.every(Boolean)),{value:l,setValue:u}=a,d=(P=o.label)!=null?P:a.label,b=(w=o.description)!=null?w:a.description,[m,p]=(0,It.useState)([]),[c,g]=(0,It.useState)(!1),{shouldShowErrors:D}=B();return(0,It.useEffect)(()=>{async function N(){if(g(!0),!s){let k=await n();p(k)}g(!1)}N()},[s]),It.default.createElement(ft,{bind:t,label:d,description:b,error:D?(I=a.error)==null?void 0:I.message:void 0},It.default.createElement(ke.MultiSelect,{label:d,isDisabled:s,items:m,isLoading:c,inputPlaceholder:e||"Select option",onSelectionChange:N=>{u(N.map(k=>k.id).join(", "))},value:l}))}var Go=C(require("react"));function cn(o){var b,m,p;let{bind:t}=o,r=nt(t),{shouldShowErrors:n}=B(),{disabled:e}=rt(),{value:a,setValue:i,isOptional:s,path:l}=r,u=(b=o.label)!=null?b:r.label,d=(m=o.description)!=null?m:r.description;return Go.default.createElement(ft,{bind:t,label:u,isRequired:!s,description:d,error:n?(p=r.error)==null?void 0:p.message:void 0},Go.default.createElement("input",{type:"checkbox",checked:a,disabled:e,onChange:c=>i(c.target.checked)}))}var te=C(require("react")),fn=()=>te.default.createElement(te.default.Fragment,null,"No inputs");var Te=require("react"),we=C(require("react")),Oe=require("@rollouthq/ui"),[gn,Rt]=(0,Oe.createContext)({name:"RolloutApiBaseUrlContext"});function Ne(o){let e=o,{children:t}=e,r=_o(e,["children"]),n=(0,Te.useMemo)(()=>r,Object.values(r));return we.default.createElement(gn,{value:n},t)}var Be=typeof document>"u"?Io.useEffect:vo.useLayoutEffect;function zt(o){let{apiBaseUrl:t}=Rt(),[r,n]=(0,Io.useState)();return Be(()=>{Object.assign(window,{ROLLOUT_CONNECT_DEPS:{zod:{z:ro.z},react:vo.default,["@rollouthq/common"]:{z:ro.z,isVariable:ro.isVariable},["@rollouthq/connect-react/components/action-inputs"]:Bt}})},[]),Be(()=>{if(o==null)return n(void 0);if(!o.appKey||!o.triggerKey)return;let e=`${t}/connect-react/${o.appKey}/triggers/${o.triggerKey}.js`;new Function("path","return import(path)")(e).then(i=>{n(i)})},[JSON.stringify(o)]),r}var Ee=require("react"),$e=C(require("react")),Le=require("@rollouthq/ui"),[yn,Me]=(0,Le.createContext)({name:"RolloutAllowedAppsContextProvider"});function Qe(o){let e=o,{children:t}=e,r=_o(e,["children"]),n=(0,Ee.useMemo)(()=>r,Object.values(r));return $e.default.createElement(yn,{value:n},t)}var je=require("react"),Ve=require("@rollouthq/api-client-react");function Re(o){let t=(0,Ve.useLazyQuery)("apps.actions");return(0,je.useEffect)(()=>{(o==null?void 0:o.appKey)!=null&&t.fetch({appKey:o.appKey})},[o==null?void 0:o.appKey]),t}var ze=require("@rollouthq/api-client-react");function Ue(o){let{allowedApps:t}=o;return(0,ze.useQuery)(["apps.list"],{select:t!=null?r=>r.filter(n=>t.includes(n.key)):void 0})}var Ze=C(require("assert")),Ye=require("react"),oe=require("@rollouthq/api-client-react/");var We=C(require("popup-centered")),Et=require("react"),qe=require("@rollouthq/api-client-react");function Po(o){let[t,r]=(0,Et.useState)(null),[n,e]=(0,Et.useState)(),{client:a}=(0,qe.useTRPCContext)();(0,Et.useEffect)(()=>{function s(l){var d;let u=l.data._rollouthq;u!=null&&u.ok?(u==null?void 0:u.type)==="credential-added"&&u.appKey===n&&u.credentialId!=null&&((d=o.onCredentialAdded)==null||d.call(o,u.credentialId)):u!=null&&u.error&&r(u.error)}return window.addEventListener("message",s,!1),()=>{window.removeEventListener("message",s)}},[n]);let i=(0,Et.useCallback)(async s=>{e(s.appKey),r(null);try{let{url:l}=await a.query("oauth.getURL",{appKey:s.appKey,customParams:s.customParams});(0,We.default)(l,"",{width:800,height:800})}catch{r("Woops! Something went wrong linking account.")}},[]);return{oauthPopupError:t,openOAuthPopup:i}}function no(o){let{appKey:t,setCredentialId:r}=o,{openOAuthPopup:n}=Po({onCredentialAdded:l=>{r(l),i.refetch()}}),a=(0,oe.useQuery)(["apps.authInfo",{appKey:t}],{enabled:t!=null}).data,i=(0,oe.useQuery)(["apps.credentials",{appKey:t}],{enabled:t!=null}),s=i.data;(0,Ye.useEffect)(()=>{if(!(a==null||s==null)){if(a.type==="none"){let l=s.length>0;return(0,Ze.default)(l,"No credentials found!"),r(s[0].id)}(a.type==="oauth1"||a.type==="oauth2")&&a.singleCredentialOnly&&(s.length===0?n({appKey:t}):r(s[0].id))}},[a,s])}var kt=require("@rollouthq/ui");var H=C(require("react"));var He=C(require("react"));var Xe=require("@rollouthq/ui");function $(o){let{apiBaseUrl:t}=Rt(),{appKey:r,css:n}=o,e=`${t}/connect-react/${r}/icon`;return He.default.createElement(Xe.st.img,{key:r,src:e,css:f({width:"1em"},n)})}var io=C(require("react")),Je=require("@rollouthq/api-client-react"),Ge=require("@rollouthq/ui/"),[bn,Fo]=(0,Ge.createContext)({name:"RolloutEndUserProvider"});function tr(o){var n;let r=(n=(0,Je.useQuery)(["end-users.getInfo"]).data)==null?void 0:n.appKey;return r==null?null:io.default.createElement(xn,{appKey:r},o.children)}function xn(o){let{appKey:t}=o,r=(0,io.useMemo)(()=>({appKey:t}),[t]);return io.default.createElement(bn,{value:r},o.children)}var So=require("ts-object-path");function Pt(o,t){if(o.success)return;let r=(0,So.createProxy)(),n=(0,So.getPath)(t(r));return o.error.issues.find(e=>e.path.join(".")===n.join("."))}var Ft=require("@rollouthq/ui");var or=require("@rollouthq/ui"),[er,V]=(0,or.createContext)({name:"AutomationForm"});function _n(o){var b,m;let{appKey:t}=Fo(),{apps:r,data:n,setData:e,validation:a}=V(),{action:i}=n,s=Pt(a,p=>p.action),l=(0,H.useMemo)(()=>{var p,c;return(c=(p=r.data)==null?void 0:p.filter(g=>g.hasActions))!=null?c:[]},[r.data]),u=(b=r.data)==null?void 0:b.find(p=>p.key===(i==null?void 0:i.appKey)),{shouldShowErrors:d}=B();return H.default.createElement("div",{className:"rollout-automation-form__action-app"},H.default.createElement("div",{style:{display:"none"}},(m=r.data)==null?void 0:m.map(p=>H.default.createElement($,{key:p.key,appKey:p.key}))),H.default.createElement(Ft.FormControl,{error:d?s==null?void 0:s.message:void 0},H.default.createElement(Ft.ComboBox,{"aria-label":"Action dropdown",defaultItems:l,selectedOption:u,isDisabled:o.isDisabled,icon:u==null?void 0:H.default.createElement($,{appKey:u.key}),inputPlaceholder:"Select app",menuTrigger:"focus",onSelectionChange:p=>e(c=>{var N;if(p==null)return x(f({},c),{action:void 0});let g=p.key===t,D=((N=c.trigger)==null?void 0:N.appKey)===t,I=g&&D||!g&&!D;return x(f({},c),{action:{appKey:p.key,inputParams:{}},trigger:I?void 0:c.trigger})})},p=>H.default.createElement(Ft.ComboBoxItem,{key:p._comboboxKey,textValue:p.name},H.default.createElement(Ft.Center,{className:"rollout-listbox__option-icon"},H.default.createElement($,{appKey:p.key})),p.name))))}function ao(o){return H.default.createElement(_n,{isDisabled:o.disabled})}var lo=C(require("react")),pr=require("@rollouthq/api-client-react/");var ur=C(require("assert")),T=C(require("react")),Do=require("@rollouthq/api-client-react");var W=C(require("react")),ir=require("@rollouthq/api-client-react"),ar=require("@rollouthq/ui");var St=C(require("react")),rr=require("@rollouthq/ui"),nr=(0,St.forwardRef)((o,t)=>{let{isTestingConnection:r,value:n,onChange:e}=o,{infoHTML:a,label:i,placeholder:s}=o.definition;return St.default.createElement("div",null,St.default.createElement("label",{className:"rollout-automation-form__api-token-input-label"},i),a!=null&&St.default.createElement("div",{dangerouslySetInnerHTML:{__html:a},className:"rollout-automation-form__api-token-input-info"}),St.default.createElement("div",null,St.default.createElement(rr.TextField,{ref:t,className:"rollout-automation-form__api-token-input","aria-label":"Token input text field",isDisabled:r,placeholder:s,value:n,onChange:e})))});function lr(o){let{appKey:t,saveApiToken:r,authType:n,firstApiTokenInput:e,openOAuthPopup:a,closeModal:i,savingApiToken:s}=o,[l,u]=(0,W.useState)({}),[d,b]=(0,W.useState)(!1),[m,p]=(0,W.useState)(!1),[c,g]=(0,W.useState)(!1),D=(0,ir.useMutation)("credentials.test-connection"),P=w();(0,W.useEffect)(()=>{d&&(b(!1),p(!1))},[l]);function w(){return"customParams"in n&&n.customParams!=null?n.customParams.every(Q=>(l==null?void 0:l[Q.key])!=null):!0}function I(){g(!0),D.mutate({appKey:t,apiToken:l},{onSuccess:Q=>{b(!0),p(Q),g(!1)}})}function N(){var Q;if(n==null)return null;if("customParams"in n)return(Q=n.customParams)==null?void 0:Q.map((et,U)=>{var h;return W.default.createElement(nr,{key:U,ref:U===0?e:void 0,definition:et,value:(h=l==null?void 0:l[et.key])!=null?h:"",onChange:j=>u(x(f({},l),{[et.key]:j})),isTestingConnection:c})})}let k=()=>{a({appKey:t,customParams:l}),g(!1),i()},L=()=>{m&&l!=null?r(l):I()};return W.default.createElement("div",{className:"rollout-automation-form__api-token-input-container"},N(),(n==null?void 0:n.type)==="apiKey"?W.default.createElement("div",{className:"rollout-automation-form__api-token-apitoken-button-container"},W.default.createElement("button",{type:"button","aria-label":"Save button",disabled:!P||c||s,className:`rollout-button--primary ${c?"rollout-automation-form__api-token-test-button":"rollout-automation-form__api-token-save-button"}`,onClick:L},(c||s)&&W.default.createElement(ar.Spinner,null),d&&m?"Save":c?"Testing Connection ...":"Test Connection"),d&&W.default.createElement("span",{className:"rollout-automation-form__api-token-connection-result"},m?"\u2705 Connection Success":"\u26A0\uFE0F Woops! Check your credentials")):W.default.createElement("button",{type:"button","aria-label":"Save button",disabled:!P||c||s,className:"rollout-button--primary",onClick:k},"Add account"))}var E=require("@rollouthq/ui"),sr={id:"ADD_OPTION",label:"Add new account",avatar:void 0,icon:T.default.createElement(E.Plus,null)};function Cn(o){let{isDisabled:t,appKey:r,setCredentialId:n,credentialId:e,authInfoQuery:a,error:i}=o,{shouldShowErrors:s}=B(),[l,u]=(0,T.useState)(!1),[d,b]=(0,T.useState)(!1),m=(0,Do.useMutation)("credentials.add-api-token"),p=(0,Do.useQuery)(["apps.credentials",{appKey:r}]),c=(0,T.useRef)(null),g=(0,T.useRef)(null),[D,P]=(0,T.useState)(!1),{openOAuthPopup:w,oauthPopupError:I}=Po({onCredentialAdded:h=>{n(h),p.refetch()}});(0,T.useEffect)(()=>{u(I!=null)},[I]);let N=(0,T.useMemo)(()=>{var h;return[...(h=p.data)!=null?h:[],sr]},[p.data]),k=N.find(h=>h.id===e),L=D?T.default.createElement(E.GreenPlus,null):k&&k.avatar!=null?T.default.createElement(E.Avatar,{src:k.avatar,name:k.label,alt:k.label}):T.default.createElement(E.Person,null);function Q(h){h!=null&&(b(!0),m.mutate({appKey:r,credential:h},{onSuccess:j=>{var v;P(!1),p.refetch(),(v=g.current)==null||v.blur(),n(j),b(!1)},onError:()=>b(!1)}))}let et=N,U=et.find(h=>h.id===e);return T.default.createElement("div",{className:"rollout-automation-form__credentials","data-avatar":!0,"data-selected":(0,E.dataAttr)((k==null?void 0:k.avatar)!=null)},T.default.createElement(E.FormControl,{error:s?i==null?void 0:i.message:void 0},T.default.createElement(E.ComboBox,{"aria-label":"Account dropdown",customRef:g,defaultItems:et,selectedOption:U,menuTrigger:"focus",icon:L,isDisabled:t,isLoading:p.isFetching||a.isFetching,inputPlaceholder:D?"Connect new account":"Select account",onSelectionChange:h=>{if(h==null)return n(void 0);let j=a.data,v=h===sr;if((0,ur.default)(j!=null,"No app auth info"),v){(j.type==="oauth1"||j.type==="oauth2")&&(j.customParams!=null?(P(!0),setTimeout(()=>{var it;return(it=c.current)==null?void 0:it.focus()})):w({appKey:r})),j.type==="apiKey"&&(P(!0),setTimeout(()=>{var it;return(it=c.current)==null?void 0:it.focus()})),u(!1);return}u(!1),P(!1),n(h.id)}},h=>(r==="gmail"||r==="googleCalendar"||r==="googleDocs"||r==="googleSheets")&&h.id==="ADD_OPTION"?T.default.createElement(E.ComboBoxItem,{key:h._comboboxKey,textValue:h.label},T.default.createElement(E.GoogleSignIn,null)):T.default.createElement(E.ComboBoxItem,{key:h._comboboxKey,textValue:h.label},T.default.createElement(E.Center,{className:"rollout-listbox__option-icon"},T.default.createElement(E.Avatar,{"aria-label":"Option icon",src:h.avatar,name:"icon"in h?null:h.label,alt:h.label,icon:"icon"in h?h.icon:void 0})),h.label))),l&&T.default.createElement("div",{className:"rollout-automation-form-oauth__error__message"},I!=null?I:"Oops! Couldn't link that account."),D&&a.data!=null&&T.default.createElement(lr,{appKey:r,authType:a.data,saveApiToken:Q,savingApiToken:d,credentialId:e,firstApiTokenInput:c,openOAuthPopup:w,closeModal:()=>P(!1)}))}function $t(o){let{appKey:t,authInfoQuery:r,credentialId:n,error:e,setCredentialId:a,isDisabled:i}=o,s=r.data;return s==null||(s.type==="oauth1"||s.type==="oauth2")&&s.singleCredentialOnly||s.type==="none"?null:T.default.createElement(Cn,{appKey:t,authInfoQuery:r,credentialId:n,setCredentialId:a,error:e,isDisabled:i})}function An(o){let{appKey:t,credentialId:r,setCredentialId:n,error:e,isDisabled:a}=o,i=(0,pr.useQuery)(["apps.authInfo",{appKey:t}]);return i.data==null?null:lo.default.createElement($t,{appKey:t,authInfoQuery:i,credentialId:r,setCredentialId:n,error:e,isDisabled:a})}function so(o){let{data:t,setData:r,validation:n}=V(),{action:e}=t,a=(0,lo.useCallback)(i=>r(s=>x(f({},s),{action:x(f({},s.action),{credentialId:i})})),[]);return(e==null?void 0:e.actionKey)==null?null:lo.default.createElement(An,{appKey:e.appKey,credentialId:e.credentialId,setCredentialId:a,error:n.success?void 0:n.error.issues.find(i=>i.path.join(".")==="action.credentialId"),isDisabled:o.disabled})}var Dt=C(require("react"));var Kt=require("@rollouthq/ui");function hn(o){var m,p;let{data:t,setData:r,actions:n,validation:e}=V(),{shouldShowErrors:a,setShouldShowErrors:i}=B(),l=(()=>e.success?null:e.error.issues.find(c=>c.path.join(".")==="action.actionKey"))(),u=t.action!=null?Dt.default.createElement($,{appKey:t.action.appKey}):void 0,d=(m=n.data)!=null?m:[],b=(p=n.data)==null?void 0:p.find(c=>{var g;return c.key===((g=t.action)==null?void 0:g.actionKey)});return Dt.default.createElement("div",{className:"rollout-automation-form__action-action"},Dt.default.createElement(Kt.FormControl,{error:a?l==null?void 0:l.message:void 0},Dt.default.createElement(Kt.ComboBox,{"aria-label":"Action dropdown",defaultItems:d,selectedOption:b,isDisabled:o.isDisabled,icon:u,isLoading:n.isLoading,inputPlaceholder:"Select action",menuTrigger:"focus",onSelectionChange:c=>(i(!1),r(g=>x(f({},g),{action:x(f({},g.action),{actionKey:c==null?void 0:c.key,inputParams:{}})})))},c=>Dt.default.createElement(Kt.ComboBoxItem,{key:c._comboboxKey,textValue:c.name},Dt.default.createElement(Kt.Center,{className:"rollout-listbox__option-icon"},u),c.name))))}function uo(o){return Dt.default.createElement(hn,{isDisabled:o.disabled})}var Cr=C(require("assert")),Mt=C(require("react"));var At=C(require("react")),yr=require("@rollouthq/api-client-react");var X=C(require("react")),mr=require("ts-assert-unreachable"),dr=require("ts-object-path"),cr=require("@rollouthq/api-client-react"),fr=require("@rollouthq/common");var gt=require("@rollouthq/ui");var vn=(0,dr.createProxy)();function Lt(o){let{api:t,credentialId:r,inputParams:n,setInputParams:e,importedData:a,variables:i,getDynamicOptions:s}=o;return X.default.createElement(ve,{value:o},"Component"in a?X.default.createElement(a.Component,{b:vn,credentialId:r,inputParams:n,setInputParams:e,api:t,useQuery:cr.useQuery,inputComponents:Bt}):X.default.createElement(X.default.Fragment,null,a.inputParamDefs.map(l=>X.default.createElement(In,{key:l.key,def:l,value:n[l.key],setValue:u=>e(x(f({},n),{[l.key]:u})),variables:i,getDynamicOptions:s}))))}function In(o){let{def:t,value:r,setValue:n,variables:e,getDynamicOptions:a}=o;function i(){if(t.type==="plainText")return X.default.createElement(gt.TextField,{className:"rollout-input",value:r!=null?r:"",onChange:n});if(t.type==="dropdown")return X.default.createElement(Pn,{def:t,value:r,setValue:n,getDynamicOptions:a});if(t.type==="string")return X.default.createElement("div",{className:"rollout-rich-text-input"},X.default.createElement(gt.RichEditor,{value:r&&(0,fr.resolveMentions)(r,e),setValue:n,formattingEnabled:!1,linksEnabled:!1,mentionVariables:e}));(0,mr.unreachableCase)(t)}return X.default.createElement(Jo,{label:t.label,isRequired:!0,error:void 0},i())}function Pn(o){var l;let{def:t,value:r,setValue:n,getDynamicOptions:e}=o,i=(l=(0,gt.useAsyncMemo)(async()=>{var u;return((u=t.dropdownConfiguration)==null?void 0:u.type)==="static"?t.dropdownConfiguration.staticOptions.map(d=>({key:d,label:d})):await e({inputKey:t.key})},[JSON.stringify(t.dropdownConfiguration)]).value)!=null?l:[],s=i.find(u=>u.key===r);return X.default.createElement(gt.ComboBox,{defaultItems:i,selectedOption:s,menuTrigger:"focus",icon:null,inputPlaceholder:"Select option",onSelectionChange:u=>{n(u==null?void 0:u.key)}},u=>X.default.createElement(gt.ComboBoxItem,{key:u._comboboxKey,textValue:u.label},u.label))}var Ko=C(require("react")),ko=require("react"),po=require("@rollouthq/common");var gr=typeof document>"u"?ko.useEffect:Ko.useLayoutEffect;function Ut(o){let{actionRef:t}=o,{apiBaseUrl:r}=Rt(),[n,e]=(0,ko.useState)();return gr(()=>{Object.assign(window,{ROLLOUT_CONNECT_DEPS:{zod:{z:po.z},react:Ko.default,["@rollouthq/common"]:{z:po.z,isVariable:po.isVariable},["@rollouthq/connect-react/components/action-inputs"]:Bt}})},[]),gr(()=>{if(t!=null){let{appKey:a,actionKey:i}=t;if(!a||!i)return;let s=`${r}/connect-react/${a}/actions/${i}.js`;new Function("path","return import(path)")(s).then(u=>e(u))}},[t==null?void 0:t.appKey,t==null?void 0:t.actionKey]),n}function br(){return At.default.createElement("div",{className:"rollout-automation-form__action-inputs"},At.default.createElement("div",null,At.default.createElement("div",{className:"rollout-automation-form__label"},"Set up action"),At.default.createElement(ee,null)))}function ee(){let{client:o}=(0,yr.useTRPCContext)(),{data:t,setData:r,variables:n}=V(),e=t.action,a=Ut({actionRef:t.action}),i=(0,At.useCallback)(s=>{r(l=>x(f({},l),{action:x(f({},l.action),{inputParams:s})}))},[r]);return a==null||e.credentialId==null?null:At.default.createElement("div",{className:"rollout-automation-form__action-inputs-wrapper"},At.default.createElement(Lt,{api:o,credentialId:e.credentialId,inputParams:e.inputParams,setInputParams:i,importedData:a,variables:n,getDynamicOptions:()=>{throw new Error("Dynamic options not implemented in actions")}}))}var To=C(require("react"));var xr=C(require("react"));function _r(o){return xr.default.createElement("div",{className:"rollout-card"},o.children)}function st(o){let{defaultField:t,ctx:r,renderer:n}=o;return n==null||n===!0?To.default.createElement(t,null):n===!1?null:n(x(f({},r),{createElement:To.createElement,Card:_r}))}function re(){var i,s,l;let{data:o,renderFields:t}=V(),{action:r}=o;(0,Cr.default)(typeof(t==null?void 0:t.action)!="function"&&typeof(t==null?void 0:t.action)!="boolean");let n=st({defaultField:ao,renderer:(i=t==null?void 0:t.action)==null?void 0:i.appKey,ctx:{ActionAppKeyField:ao}}),e=st({defaultField:uo,renderer:(s=t==null?void 0:t.action)==null?void 0:s.actionKey,ctx:{ActionKeyField:uo}}),a=st({defaultField:so,renderer:(l=t==null?void 0:t.action)==null?void 0:l.credentialId,ctx:{ActionCredentialIdField:so}});return Mt.default.createElement(Mt.default.Fragment,null,Mt.default.createElement("div",{className:"rollout-automation-form__action"},Mt.default.createElement("div",{className:"rollout-automation-form__label"},"Select action"),Mt.default.createElement("div",{className:"rollout-automation-form__helper-text"},"This is what your automation will do when triggered"),n,e,a),(r==null?void 0:r.actionKey)!=null&&r.credentialId!=null&&Mt.default.createElement(br,null))}var Fr=C(require("assert")),q=C(require("react")),Sr=require("@rollouthq/api-client-react");var yt=C(require("react")),Ar=require("@rollouthq/api-client-react");var bt=require("@rollouthq/ui");function Fn(o){var b;let{appKey:t}=Fo(),{data:r,setData:n,validation:e}=V(),{trigger:a}=r,i=(0,Ar.useQuery)(["triggers.apps"]),{shouldShowErrors:s}=B(),l=Pt(e,m=>m.trigger),u=(b=i.data)!=null?b:[],d=u==null?void 0:u.find(m=>m.key===(a==null?void 0:a.appKey));return yt.default.createElement("div",{className:"rollout-automation-form__trigger-app"},yt.default.createElement(bt.FormControl,{error:s?l==null?void 0:l.message:void 0},yt.default.createElement(bt.ComboBox,{"aria-label":"Trigger app dropdown",defaultItems:u,selectedOption:d,menuTrigger:"focus",icon:a==null?yt.default.createElement(bt.Rocket,null):yt.default.createElement($,{appKey:a.appKey}),isDisabled:o.isDisabled,inputPlaceholder:"Select app",onSelectionChange:m=>n(p=>{var I;if(m==null)return x(f({},p),{trigger:void 0});let c=m.key===t,g=((I=p.action)==null?void 0:I.appKey)===t,w=c&&g||!c&&!g;return x(f({},p),{trigger:{appKey:m.key,inputParams:{}},action:w?void 0:p.action})})},m=>yt.default.createElement(bt.ComboBoxItem,{key:m._comboboxKey,textValue:m.name},yt.default.createElement(bt.Center,{className:"rollout-listbox__option-icon"},yt.default.createElement($,{appKey:m.key})),m.name))))}function mo(o){return yt.default.createElement(Fn,{isDisabled:o.disabled})}var xt=C(require("react")),hr=require("@rollouthq/api-client-react");var ut=require("@rollouthq/ui");function Sn(o){var b;let{isDisabled:t}=o,{shouldShowErrors:r}=B(),{validation:n,data:e,setData:a}=V(),{trigger:i}=e,s=(0,hr.useQuery)(["apps.triggers",{appKey:i==null?void 0:i.appKey}],{enabled:(i==null?void 0:i.appKey)!=null}),l=Pt(n,m=>m.trigger.triggerKey),u=(b=s.data)!=null?b:[],d=u.find(m=>m.key===(i==null?void 0:i.triggerKey));return xt.default.createElement(ut.FormControl,{error:r?l==null?void 0:l.message:void 0},xt.default.createElement(ut.ComboBox,{"aria-label":"Trigger dropdown",defaultItems:u,selectedOption:d,menuTrigger:"focus",isDisabled:t||s.isLoading,icon:(i==null?void 0:i.appKey)==null?xt.default.createElement(ut.Rocket,null):xt.default.createElement($,{appKey:i==null?void 0:i.appKey}),inputPlaceholder:"Select trigger",onSelectionChange:m=>a(p=>x(f({},p),{trigger:x(f({},p.trigger),{triggerKey:m==null?void 0:m.key,inputParams:{}})}))},m=>xt.default.createElement(ut.ComboBoxItem,{key:m._comboboxKey,textValue:m.name},xt.default.createElement(ut.Center,{className:"rollout-listbox__option-icon"},(i==null?void 0:i.appKey)==null?xt.default.createElement(ut.Rocket,null):xt.default.createElement($,{appKey:i==null?void 0:i.appKey})),m.name)))}function co(o){return xt.default.createElement(Sn,{isDisabled:o.disabled})}var vr=C(require("react")),Ir=require("@rollouthq/api-client-react");function Pr(o){let{appKey:t,credentialId:r,setCredentialId:n,error:e,isDisabled:a}=o,i=(0,Ir.useQuery)(["apps.authInfo",{appKey:t}]);return i.data==null?null:vr.default.createElement($t,{appKey:t,authInfoQuery:i,credentialId:r,setCredentialId:n,error:e,isDisabled:a})}function ne(){var p,c;let{client:o}=(0,Sr.useTRPCContext)(),{data:t,setData:r,renderFields:n,validation:e}=V(),{trigger:a}=t,i=zt(a),s=(0,q.useCallback)(g=>{r(D=>x(f({},D),{trigger:x(f({},D.trigger),{inputParams:g})}))},[r]),l=(0,q.useCallback)(g=>r(D=>x(f({},D),{trigger:x(f({},D.trigger),{credentialId:g})})),[r]),u=(0,q.useMemo)(()=>[],[]);(0,Fr.default)(typeof(n==null?void 0:n.trigger)!="function"&&typeof(n==null?void 0:n.trigger)!="boolean");let d=st({defaultField:mo,renderer:(p=n==null?void 0:n.trigger)==null?void 0:p.appKey,ctx:{TriggerAppKeyField:mo}}),b=st({defaultField:co,renderer:(c=n==null?void 0:n.trigger)==null?void 0:c.triggerKey,ctx:{TriggerKeyField:co}}),m=i&&("inputParamsSchema"in i?Object.keys(i.inputParamsSchema.shape).length>0:i.inputParamDefs.length>0);return q.default.createElement("div",{className:"rollout-automation-form__trigger"},q.default.createElement("div",{className:"rollout-automation-form__label"},"Select trigger"),q.default.createElement("div",{className:"rollout-automation-form__helper-text"},"This is the event that will kick off your action"),d,q.default.createElement("div",{className:"rollout-automation-form__trigger-trigger"},b),(a==null?void 0:a.triggerKey)!=null&&q.default.createElement(Pr,{appKey:a.appKey,credentialId:a.credentialId,setCredentialId:l,error:e.success?void 0:e.error.issues.find(g=>g.path.join(".")==="trigger.credentialId")}),(a==null?void 0:a.credentialId)!=null&&m&&q.default.createElement("div",{className:"rollout-automation-form__trigger-inputs"},q.default.createElement("div",{className:"rollout-automation-form__trigger-inputs-wrapper"},q.default.createElement(Lt,{api:o,credentialId:a.credentialId,inputParams:a.inputParams,setInputParams:s,importedData:i,variables:u,getDynamicOptions:({inputKey:g})=>o.query("triggers.getTriggerInputOptions",{triggerKey:a.triggerKey,inputKey:g})}))))}var ie=C(require("react"));var Dr=require("@rollouthq/ui");function Dn(o){var s;let{disabled:t=!1}=o,{data:r,setData:n,validation:e}=V(),{shouldShowErrors:a}=B(),i=Pt(e,l=>l.name)!=null;return ie.default.createElement(Dr.TextField,{"aria-label":"Automation Name Input",className:"rollout-automation-form__name",placeholder:"Give your automation a name",isDisabled:t,value:(s=r.name)!=null?s:"",validationState:a&&i?"invalid":"valid",onChange:l=>n(u=>x(f({},u),{name:l}))})}function ae(o){return ie.default.createElement(Dn,f({},o))}var le=require("react"),J=require("zod"),Wt=J.z.object({name:J.z.string().min(1),trigger:J.z.object({appKey:J.z.string(),triggerKey:J.z.string(),credentialId:J.z.string(),inputParams:J.z.object({})}),action:J.z.object({appKey:J.z.string(),actionKey:J.z.string(),credentialId:J.z.string(),inputParams:J.z.object({})})});function Kr(o){let{data:t,actionInputParamsSchema:r,triggerInputParamsSchema:n}=o,e=(0,le.useMemo)(()=>Wt.extend({trigger:Wt.shape.trigger.extend({inputParams:n}),action:Wt.shape.action.extend({inputParams:r})}),[n,r]);return(0,le.useMemo)(()=>e.safeParse(t),[t,e])}function Oo(o){var Ht,Xt,Jt,Gt,to;let{data:t,isSaving:r,onSave:n,onCancel:e,onUpdate:a,onDelete:i,mode:s,renderFields:l}=o,[u,d]=(0,kr.useState)(!1),[b,m]=(0,kt.useToggle)(),{client:p}=(0,wo.useTRPCContext)(),g=(Jt=(0,wo.useQuery)(["apps.triggers",{appKey:(Ht=t.trigger)==null?void 0:Ht.appKey}],{enabled:((Xt=t.trigger)==null?void 0:Xt.appKey)!=null}).data)==null?void 0:Jt.find(R=>{var M;return R.key===((M=t.trigger)==null?void 0:M.triggerKey)}),D=(0,kt.useAsyncMemo)(async()=>{var R,M,at;return g==null?[]:g.payloadConfiguration.type==="static"?g.payloadConfiguration.staticSchema:await p.query("triggers.getPayloadSchema",{appKey:(R=t.trigger)==null?void 0:R.appKey,triggerKey:(M=t.trigger)==null?void 0:M.triggerKey,inputParams:(at=t.trigger)==null?void 0:at.inputParams})},[JSON.stringify(g==null?void 0:g.payloadConfiguration),JSON.stringify(t.trigger)]),P=(0,F.useMemo)(()=>{var R;return((R=D.value)!=null?R:[]).map(M=>({id:M.key,label:M.label,type:"string"}))},[D.value]),{allowedApps:w}=Me(),I=Ue({allowedApps:w}),N=Re(t.action),k=Ut({actionRef:t.action}),L=zt(t.trigger),Q=(0,F.useMemo)(()=>L==null?Wt.shape.action.shape.inputParams:"inputParamsSchema"in L?L.inputParamsSchema:(0,se.inputDefToZodObject)(L.inputParamDefs),[L]),et=(0,F.useMemo)(()=>k==null?Wt.shape.action.shape.inputParams:"inputParamsSchema"in k?k.inputParamsSchema:(0,se.inputDefToZodObject)(k.inputParamDefs),[k]),U=Kr({data:t,triggerInputParamsSchema:Q,actionInputParamsSchema:et}),h=(0,F.useCallback)(R=>a(M=>{var oo,xe;let at=R(M),_=((oo=M.trigger)==null?void 0:oo.triggerKey)!==((xe=at.trigger)==null?void 0:xe.triggerKey),K=at.action==null?void 0:x(f({},at.action),{inputParams:_?{}:at.action.inputParams});return x(f({},at),{action:K})}),[a]),j=(0,F.useMemo)(()=>({data:t,apps:I,actions:N,validation:U,variables:P,setData:h,renderFields:l}),[t,I,N,U,P,h,l]),v=(0,F.useMemo)(()=>({shouldShowErrors:u,setShouldShowErrors:d}),[u,d]),it=(0,F.useCallback)(R=>h(M=>x(f({},M),{trigger:x(f({},M.trigger),{credentialId:R})})),[h]),Uo=(0,F.useCallback)(R=>h(M=>x(f({},M),{action:x(f({},M.action),{credentialId:R})})),[h]);no({appKey:(Gt=t.trigger)==null?void 0:Gt.appKey,setCredentialId:it}),no({appKey:(to=t.action)==null?void 0:to.appKey,setCredentialId:Uo});let yo=I.data==null,Wo=(0,Tr.useSpinDelay)(yo,{delay:500,minDuration:200});if(I.failureCount>0)return F.default.createElement("div",{className:"rollout-automations-list__error-msg"},"Woops! Something went wrong fetching automations.");if(yo||Wo)return F.default.createElement("div",{className:"rollout__loading_spinner_container"},F.default.createElement(kt.Spinner,{className:"rollout__loading_spinner"}));let qo=st({defaultField:ae,renderer:l==null?void 0:l.name,ctx:{NameField:ae}}),Zo=typeof(l==null?void 0:l.trigger)=="object"?F.default.createElement(ne,null):st({defaultField:ne,renderer:l==null?void 0:l.trigger,ctx:{TriggerAppKeyField:mo,TriggerKeyField:co}}),bo=typeof(l==null?void 0:l.action)=="object"?F.default.createElement(re,null):st({defaultField:re,renderer:l==null?void 0:l.action,ctx:{ActionAppKeyField:ao,ActionKeyField:uo,ActionCredentialIdField:so,ActionInputFields:ee}});return F.default.createElement(Co,{value:v},F.default.createElement(er,{value:j},F.default.createElement("div",{className:"rollout-automation-form"},F.default.createElement("div",{className:"rollout-automation-form__header"},qo),F.default.createElement("div",{className:"rollout-automation-form__content"},Zo,bo),F.default.createElement("div",{className:"rollout-automation-form__buttons"},F.default.createElement("button",{type:"button","aria-label":"Save button",className:"rollout-button--primary rollout-automation-form__submit","data-loading":(0,kt.dataAttr)(r),onClick:()=>{d(!0),U.success?n(U.data):console.error(U.error)}},r?"Saving...":"Save"),e!=null&&F.default.createElement("button",{type:"button","aria-label":"Cancel button",className:"rollout-button--secondary rollout-automation-form__cancel",onClick:()=>e()},"Cancel"),s!=="create"&&F.default.createElement("div",{className:"rollout-automation-form__delete"},b&&F.default.createElement("div",{className:"rollout-automation-form-delete__confirm-dialog"},F.default.createElement("div",{className:"rollout-automation-form__delete-confirm-text"},"Are you sure you want to delete this automation?"),F.default.createElement("div",{className:"rollout-automation-form__delete-confirm-buttons"},F.default.createElement("button",{type:"button","aria-label":"Cancel deletion button",onClick:m,className:"rollout-button--secondary rollout-automation-form__delete-cancel"},"No, cancel"),F.default.createElement("button",{type:"button","aria-label":"Confirm deletion button",onClick:i,className:"rollout-button--danger rollout-automation-form__delete-confirm"},"Yes, delete"))),F.default.createElement("button",{type:"button","aria-label":"Delete button",className:"rollout-button--danger rollout-automations-form-delete__trigger",onClick:m},"Delete"))))))}function No(o){let{onAutomationCreated:t,onBeforeAutomationCreate:r,onCancel:n,prefilled:e,renderFields:a}=o,i=(0,wr.useMutation)("automations.create"),[s,l]=(0,fo.useState)(()=>{var b,m,p,c;let d={};return e==null||(e.name&&(d.name=e.name),((b=e.trigger)==null?void 0:b.appKey)!=null&&(d.trigger=x(f({},e.trigger),{appKey:e.trigger.appKey,inputParams:(m=e.trigger.inputParams)!=null?m:{}})),((p=e.action)==null?void 0:p.appKey)!=null&&(d.action=x(f({},e.action),{appKey:e.action.appKey,inputParams:(c=e.action.inputParams)!=null?c:{}}))),d}),u=async d=>{let b=await(r==null?void 0:r({automationData:d}));if(b===!1)return;let m=b===!0||b===void 0?d:b.automationData,p=await i.mutateAsync(m);t({automation:p})};return fo.default.createElement("div",{className:"rollout-automation-creator"},fo.default.createElement(Oo,{mode:"create",data:s,renderFields:a,onUpdate:l,isSaving:i.isLoading,onSave:u,onCancel:n}))}var qt=C(require("react")),Qt=require("@rollouthq/api-client-react");function Bo(o){let{automationId:t,onAutomationDeleted:r,onAutomationUpdated:n,onCancel:e,renderFields:a}=o,{invalidateQueries:i}=(0,Qt.useTRPCContext)(),s=(0,Qt.useMutation)("automations.delete",{onSuccess:()=>i(["automations.list"])}),[l,u]=(0,qt.useState)({}),d=(0,Qt.useQuery)(["automations.get",{automationId:t}],{onSuccess(c){c!=null&&u({name:c.name,action:c.action,trigger:c.trigger})}}),b=(0,Qt.useMutation)("automations.update");if(d.isLoading)return null;if(d.data==null)return qt.default.createElement("div",{className:"rollout-automations-editor__not-found"},"Automation not found");let m=async c=>{let g=await b.mutateAsync({id:t,automationData:{name:c.name,action:c.action,trigger:c.trigger}});n==null||n(g)},p=()=>{s.mutate({id:d.data.id},{onSuccess:()=>{r==null||r()}})};return qt.default.createElement("div",{className:"rollout-automation-editor"},qt.default.createElement(Oo,{mode:"edit",data:l,renderFields:a,onUpdate:u,isSaving:b.isLoading,onSave:m,onDelete:p,onCancel:e}))}var _t=C(require("react"));var pt=C(require("react")),Zt=require("@rollouthq/api-client-react");var ue=require("match-sorter"),S=C(require("react"));var Z=require("@rollouthq/ui"),Eo=require("@rollouthq/ui");function Or(o){let{automations:t,isLoading:r=!1,isDeleting:n=!1,onEditAutomation:e,onDeleteAutomation:a}=o,[i,s]=(0,S.useState)(""),l=(0,ue.matchSorter)(t,i,{keys:["name","action.app.name"],threshold:ue.matchSorter.rankings.ACRONYM}),u=l.length===0;return S.default.createElement("div",{className:"rollout-automations-list__container"},S.default.createElement("div",{className:"rollout-automations-list__search-input__group"},S.default.createElement("div",{className:"rollout-automations-list__search-input__left-element"},S.default.createElement(Z.Search,null)),S.default.createElement(Z.TextField,{"aria-label":"Search automations text field",placeholder:"Search automations",value:i,onChange:s,className:"rollout-automations-list__search-input"})),r&&S.default.createElement("div",{className:"rollout__loading_spinner_container"},S.default.createElement(Z.Spinner,{className:"rollout__loading_spinner"})),!r&&u&&S.default.createElement("div",{className:"rollout-automations-list__empty-msg"},"No automations found"),S.default.createElement("div",{className:"rollout-automations-list__list"},l.map(d=>S.default.createElement(Kn,{key:d.id,automation:d,onEdit:()=>e(d),onDelete:()=>a(d),isDeleting:n}))))}function Kn(o){let{automation:t,onEdit:r,onDelete:n,isDeleting:e}=o,[a,i]=(0,Eo.useToggle)(),[s,l]=(0,S.useState)(!1);(0,S.useEffect)(()=>{!e&&s&&l(!1)},[e]);let u=a&&S.default.createElement("div",{className:"rollout-automations-list-item__options__content",onMouseLeave:()=>{a&&i()}},S.default.createElement("span",null,"Really delete?"),S.default.createElement("button",{type:"button","aria-label":"Confirm deletion button",onClick:()=>{n(),l(!0)},className:"rollout-automations-list-item__options__delete-item-btn"},"Delete"),S.default.createElement("button",{type:"button","aria-label":"Cancel deletion button",onClick:i,className:"rollout-automations-list-item__options__cancel-item-btn"},"Cancel"));return S.default.createElement("div",{className:"rollout-automations-list__item-wrapper","data-deleting":(0,Z.dataAttr)(s)},u,S.default.createElement("div",{className:"rollout-automations-list__item",role:"group","data-open":(0,Z.dataAttr)(a),onClick:d=>{(0,Z.isChildofInteractiveElement)(d.target)||r()}},S.default.createElement("div",{className:"rollout-automations-list-item__header"},S.default.createElement("div",{className:"rollout-automations-list-item__icons"},S.default.createElement(Z.Center,{className:"rollout-automations-list-item__trigger"},S.default.createElement($,{appKey:t.trigger.appKey})),S.default.createElement(Z.Center,{className:"rollout-automations-list-item__action"},S.default.createElement($,{appKey:t.action.appKey}))),S.default.createElement("div",{role:"button",className:"rollout-automations-list-item__options__trigger",onClick:i},S.default.createElement(Eo.Trash,null))),S.default.createElement("div",{className:"rollout-automations-list-item__name"},t.name)))}var Nr=require("@rollouthq/ui");function $o(o){let{onEditAutomation:t,onCreateAutomation:r,filter:n}=o,{invalidateQueries:e}=(0,Zt.useTRPCContext)(),[a,i]=(0,pt.useState)(()=>[]),s=(0,Zt.useQuery)(["automations.list"]);(0,pt.useEffect)(()=>{s.data!=null&&(n!=null?i(s.data.filter(u=>{try{return n(u)}catch(d){return console.error(d),!1}})):i(s.data))},[s.data,n]);let l=(0,Zt.useMutation)("automations.delete",{onSuccess:()=>e(["automations.list"])});return pt.default.createElement("div",null,pt.default.createElement("div",{className:"rollout-automations-list__header"},pt.default.createElement("span",{className:"rollout-automations-list__header-title"},"My automations"),pt.default.createElement("button",{type:"button","aria-label":"New automation button",className:"rollout-automations-list__new-btn",onClick:()=>r()},pt.default.createElement(Nr.Plus,null),"New")),pt.default.createElement(Or,{automations:a!=null?a:[],isLoading:s.isFetching,isDeleting:l.isLoading,onDeleteAutomation:u=>l.mutate({id:u.id}),onEditAutomation:t}))}var Br=require("@rollouthq/ui");function Er(o){let{onAutomationCreated:t,onBeforeAutomationCreate:r,prefilled:n,filter:e,renderFields:a}=o,[i,s]=(0,_t.useState)({mode:"LIST"});return _t.default.createElement("div",{className:"rollout-automations-manager"},i.mode==="LIST"&&_t.default.createElement($o,{onEditAutomation:l=>s({mode:"EDIT",automationId:l.id}),onCreateAutomation:()=>s({mode:"CREATE"}),filter:e}),(i.mode==="CREATE"||i.mode==="EDIT")&&_t.default.createElement("div",{className:"rollout-automations-manager__navbar"},_t.default.createElement("button",{type:"button","aria-label":"Return to automations list button",className:"rollout-automations-manager__back-btn",onClick:()=>s({mode:"LIST"})},_t.default.createElement(Br.ArrowBack,{className:"rollout-automation-form__header-back__arrow"}))),i.mode==="CREATE"&&_t.default.createElement(No,{onBeforeAutomationCreate:r,onAutomationCreated:l=>{t==null||t(l),s({mode:"LIST"})},prefilled:n,renderFields:a}),i.mode==="EDIT"&&_t.default.createElement(Bo,{automationId:i.automationId,onAutomationUpdated:()=>s({mode:"LIST"}),onAutomationDeleted:()=>s({mode:"LIST"}),renderFields:a}))}var A=C(require("react")),Lr=require("spin-delay"),tt=require("@rollouthq/api-client-react"),me=require("@rollouthq/common/");var ht=require("@rollouthq/ui");var pe=require("react"),G=require("zod"),Yt=G.z.object({name:G.z.string().min(1),trigger:G.z.object({appKey:G.z.string(),triggerKey:G.z.string(),credentialId:G.z.string(),inputParams:G.z.object({})}),action:G.z.object({appKey:G.z.string(),actionKey:G.z.string(),credentialId:G.z.string(),inputParams:G.z.object({})})});function $r(o){let{data:t={},actionInputParamsSchema:r,triggerInputParamsSchema:n}=o,e=(0,pe.useMemo)(()=>Yt.extend({trigger:Yt.shape.trigger.extend({inputParams:n}),action:Yt.shape.action.extend({inputParams:r})}),[r,n]);return(0,pe.useMemo)(()=>e.safeParse(t),[t,e])}function Lo(o){var bo,Ht,Xt,Jt,Gt,to,R,M,at;let{blueprintId:t}=o,{client:r,invalidateQueries:n}=(0,tt.useTRPCContext)(),[e,a]=(0,A.useState)(),i=(0,tt.useLazyQuery)("triggers.getPayloadSchema"),s=(0,tt.useLazyQuery)("apps.authInfo"),l=(0,tt.useLazyQuery)("apps.triggers"),u=zt(e==null?void 0:e.trigger);(0,A.useEffect)(()=>{let _=e==null?void 0:e.trigger;_!=null&&(s.fetch({appKey:_.appKey}),l.fetch({appKey:_.appKey}),_.triggerKey!=null&&_.appKey!=null&&i.fetch({appKey:_.appKey,triggerKey:_.triggerKey}))},[e==null?void 0:e.trigger]);let d=(0,tt.useLazyQuery)("apps.authInfo");(0,A.useEffect)(()=>{var _;((_=e==null?void 0:e.action)==null?void 0:_.appKey)!=null&&d.fetch({appKey:e.action.appKey})},[(bo=e==null?void 0:e.action)==null?void 0:bo.appKey]);let b=(0,tt.useQuery)(["blueprints.get",{blueprintId:t}],{onSuccess:_=>{e==null&&(_.automation!=null?a({name:_.automation.name,action:_.automation.action,trigger:_.automation.trigger}):a({name:_.name,action:_.action,trigger:_.trigger}))}}),m=(0,tt.useMutation)("blueprints.createAutomation"),p=(0,tt.useMutation)("blueprints.deactivateAutomation"),c=(0,A.useMemo)(()=>u==null?Yt.shape.action.shape.inputParams:"inputParamsSchema"in u?u.inputParamsSchema:(0,me.inputDefToZodObject)(u.inputParamDefs),[u]),g=Ut({actionRef:e==null?void 0:e.action}),D=(0,A.useMemo)(()=>g==null?Yt.shape.action.shape.inputParams:"inputParamsSchema"in g?g.inputParamsSchema:(0,me.inputDefToZodObject)(g.inputParamDefs),[g]),P=$r({data:e,triggerInputParamsSchema:c,actionInputParamsSchema:D}),w=(0,A.useCallback)(_=>a(K=>x(f({},K),{trigger:x(f({},K==null?void 0:K.trigger),{credentialId:_})})),[a]),I=(0,A.useCallback)(_=>a(K=>x(f({},K),{action:x(f({},K==null?void 0:K.action),{credentialId:_})})),[a]);no({appKey:(Ht=e==null?void 0:e.trigger)==null?void 0:Ht.appKey,setCredentialId:w});let N=(0,A.useCallback)(_=>{a(K=>x(f({},K),{trigger:x(f({},K.trigger),{inputParams:_})}))},[a]),L=(Gt=(0,tt.useQuery)(["apps.triggers",{appKey:(Xt=e==null?void 0:e.trigger)==null?void 0:Xt.appKey}],{enabled:((Jt=e==null?void 0:e.trigger)==null?void 0:Jt.appKey)!=null}).data)==null?void 0:Gt.find(_=>{var K;return _.key===((K=e==null?void 0:e.trigger)==null?void 0:K.triggerKey)}),Q=(0,ht.useAsyncMemo)(async()=>{var _,K,oo;return L==null?[]:L.payloadConfiguration.type==="static"?L.payloadConfiguration.staticSchema:await r.query("triggers.getPayloadSchema",{appKey:(_=e==null?void 0:e.trigger)==null?void 0:_.appKey,triggerKey:(K=e==null?void 0:e.trigger)==null?void 0:K.triggerKey,inputParams:(oo=e==null?void 0:e.trigger)==null?void 0:oo.inputParams})},[JSON.stringify(L==null?void 0:L.payloadConfiguration),JSON.stringify(e==null?void 0:e.trigger)]),et=(0,A.useMemo)(()=>{var _;return((_=Q.value)!=null?_:[]).map(K=>({id:K.key,label:K.label,type:"string"}))},[Q.value]);function U(){return(e==null?void 0:e.action)==null||g==null?null:A.default.createElement("div",{className:"rollout-automation-form__action-inputs"},A.default.createElement("div",null,A.default.createElement("div",{className:"rollout-automation-form__label"},"Set up action"),A.default.createElement("div",{className:"rollout-automation-form__credential"},A.default.createElement(ht.FormControl,{label:"Account",isRequired:!0},A.default.createElement($t,{error:P.success?void 0:P.error.issues.find(_=>_.path.join(".")==="action.credentialId"),credentialId:e.action.credentialId,setCredentialId:_=>{let K=x(f({},e.action),{credentialId:_});a(x(f({},e),{action:K}))},authInfoQuery:d,appKey:e.action.appKey}))),A.default.createElement("div",{className:"rollout-automation-form__action-inputs-wrapper"},A.default.createElement(Lt,{isBlueprintActivation:!0,api:r,credentialId:e.action.credentialId,inputParams:e.action.inputParams,setInputParams:_=>a(x(f({},e),{action:x(f({},e.action),{inputParams:_})})),importedData:g,variables:et,getDynamicOptions:()=>{throw new Error("Dynamic options not implemented in actions")}}))))}let h=(M=(R=(to=b.data)==null?void 0:to.automation)==null?void 0:R.active)!=null?M:!1,[j,v]=(0,A.useState)(!1),it=(0,A.useMemo)(()=>({shouldShowErrors:j,setShouldShowErrors:v}),[j,v]),Uo=(0,A.useMemo)(()=>[],[]);async function yo(){if(v(!0),P.success){let _=P.data;await m.mutateAsync({blueprintId:t,trigger:{credentialId:_.trigger.credentialId,inputParams:_.trigger.inputParams},action:{credentialId:_.action.credentialId,inputParams:_.action.inputParams}}),n(["blueprints.getAutomation",{blueprintId:t}]),n(["blueprints.get",{blueprintId:t}]),n("blueprints.list")}else console.log(e),console.error(P.error)}async function Wo(){await p.mutateAsync({blueprintId:t}),n(["blueprints.getAutomation",{blueprintId:t}]),n(["blueprints.get",{blueprintId:t}]),n("blueprints.list")}let be=(0,Lr.useSpinDelay)(e==null,{delay:500,minDuration:200});if(e==null)return null;if(be)return A.default.createElement("div",{className:"rollout__loading_spinner_container"},A.default.createElement(ht.Spinner,{className:"rollout__loading_spinner"}));let qo=u&&("inputParamsSchema"in u?Object.keys(u.inputParamsSchema.shape).length>0:u.inputParamDefs.length>0),Zo=((at=e.trigger)==null?void 0:at.triggerKey)!=null&&A.default.createElement("div",{className:"rollout-blueprint-activator__trigger"},A.default.createElement("div",{className:"rollout-blueprint-activator__label"},"Set up trigger"),A.default.createElement("div",{className:"rollout-blueprint-activator__trigger__fields"},A.default.createElement($t,{error:P.success?void 0:P.error.issues.find(_=>_.path.join(".")==="trigger.credentialId"),appKey:e.trigger.appKey,setCredentialId:_=>a(x(f({},e),{trigger:x(f({},e.trigger),{credentialId:_})})),authInfoQuery:s,credentialId:e.trigger.credentialId}),e.trigger.credentialId!=null&&qo&&A.default.createElement("div",{className:"rollout-automation-form__trigger-inputs-wrapper"},A.default.createElement(Lt,{api:r,credentialId:e.trigger.credentialId,inputParams:e.trigger.inputParams,setInputParams:N,importedData:u,variables:Uo,getDynamicOptions:({inputKey:_})=>{var K;return r.query("triggers.getTriggerInputOptions",{triggerKey:(K=e.trigger)==null?void 0:K.triggerKey,inputKey:_})}}))));return A.default.createElement(Co,{value:it},A.default.createElement("div",null,b.data!=null&&A.default.createElement("div",null,A.default.createElement("div",{className:"rollout-blueprint-activator__header"},A.default.createElement("div",{className:"rollout-automations-list-item__icons"},A.default.createElement(ht.Center,{className:"rollout-automations-list-item__trigger"},A.default.createElement($,{appKey:b.data.trigger.appKey})),A.default.createElement(ht.Center,{className:"rollout-automations-list-item__action"},A.default.createElement($,{appKey:b.data.action.appKey}))),A.default.createElement("div",{className:"rollout-blueprint-activator__name"},b.data.name)),Zo,U(),A.default.createElement("div",null,h?A.default.createElement("button",{type:"button","aria-label":"Deactivation button",disabled:m.isLoading,className:"rollout-blueprint-activator__deactivate-btn rollout-button--primary",onClick:Wo},m.isLoading?"Deactivating...":"Deactivate"):A.default.createElement("button",{type:"button","aria-label":"Activation button",disabled:m.isLoading,className:"rollout-blueprint-activator__activate-btn rollout-button--primary",onClick:yo},m.isLoading?"Activating...":"Activate")))))}var de=require("match-sorter"),O=C(require("react")),Mo=require("@rollouthq/api-client-react");var ot=require("@rollouthq/ui");function Qo(o){let{blueprints:t,isLoading:r=!1,onOpenActivationForm:n}=o,[e,a]=(0,O.useState)(""),i=(0,de.matchSorter)(t,e,{keys:["name","action.app.name"],threshold:de.matchSorter.rankings.ACRONYM}),s=i.length===0;return O.default.createElement("div",{className:"rollout-automations-list__container"},O.default.createElement("div",{className:"rollout-automations-list__search-input__group"},O.default.createElement("div",{className:"rollout-automations-list__search-input__left-element"},O.default.createElement(ot.Search,null)),O.default.createElement(ot.TextField,{placeholder:"Search blueprints",value:e,onChange:a,className:"rollout-automations-list__search-input"})),r&&O.default.createElement("div",{className:"rollout__loading_spinner_container"},O.default.createElement(ot.Spinner,{className:"rollout__loading_spinner"})),!r&&s&&O.default.createElement("div",{className:"rollout-automations-list__empty-msg"},"No blueprints found"),O.default.createElement("div",{className:"rollout-automations-list__list"},i.map(l=>O.default.createElement(kn,{key:l.id,blueprint:l,onOpenActivationForm:()=>n(l)}))))}function kn(o){var i,s;let{blueprint:t,onOpenActivationForm:r}=o,{invalidateQueries:n}=(0,Mo.useTRPCContext)(),e=(0,Mo.useMutation)("blueprints.deactivateAutomation"),a=(s=(i=t.automation)==null?void 0:i.active)!=null?s:!1;return O.default.createElement("div",{className:"rollout-automations-list__item-wrapper"},O.default.createElement("div",{className:"rollout-automations-list__item",role:"group",onClick:l=>{(0,ot.isChildofInteractiveElement)(l.target)||r()}},O.default.createElement("div",{className:"rollout-automations-list-item__header"},O.default.createElement("div",{className:"rollout-automations-list-item__icons"},O.default.createElement(ot.Center,{className:"rollout-automations-list-item__trigger"},O.default.createElement($,{appKey:t.trigger.appKey})),O.default.createElement(ot.Center,{className:"rollout-automations-list-item__action"},O.default.createElement($,{appKey:t.action.appKey}))),O.default.createElement("div",{className:"rollout-automations-list-item__switch"},O.default.createElement(ot.Switch,{isSelected:a,onChange:async()=>{if(a){let l=t.id;await e.mutateAsync({blueprintId:l}),n(["blueprints.get",{blueprintId:l}]),n(["blueprints.getAutomation",{blueprintId:l}]),n(["blueprints.list"])}else r()}}))),O.default.createElement("div",{className:"rollout-automations-list-item__name"},t.name)))}var mt=C(require("react"));var go=C(require("react")),Mr=require("@rollouthq/api-client-react");function jo(o){var n;let{onOpenActivationForm:t}=o,r=(0,Mr.useQuery)(["blueprints.list"]);return go.default.createElement("div",null,go.default.createElement("div",{className:"rollout-automations-list__header"},go.default.createElement("span",{className:"rollout-automations-list__header-title"},"My blueprints")),go.default.createElement(Qo,{blueprints:(n=r.data)!=null?n:[],isLoading:r.isFetching,onOpenActivationForm:t}))}var Qr=require("@rollouthq/ui");function jr(){let[o,t]=(0,mt.useState)({mode:"LIST"});return mt.default.createElement("div",{className:"rollout-automations-manager"},o.mode==="LIST"&&mt.default.createElement(jo,{onOpenActivationForm:r=>{t({mode:"ACTIVATE",blueprintId:r.id})}}),o.mode==="ACTIVATE"&&mt.default.createElement(mt.default.Fragment,null,mt.default.createElement("div",{className:"rollout-automations-manager__navbar"},mt.default.createElement("button",{type:"button","aria-label":"Return to blueprints list button",className:"rollout-blueprints-manager__back-btn",onClick:()=>t({mode:"LIST"})},mt.default.createElement(Qr.ArrowBack,{className:"rollout-automation-form__header-back__arrow"}))),mt.default.createElement(Lo,{blueprintId:o.blueprintId})))}var Tt=C(require("react")),vt=require("@rollouthq/ui");function Vr(){return Tt.default.createElement(vt.st.div,{css:{textAlign:"center"}},Tt.default.createElement(vt.st.div,{css:{display:"flex",justifyContent:"center",alignItems:"center"}},Tt.default.createElement(vt.RolloutIcon,{width:"16px"}),Tt.default.createElement(vt.st.span,{css:{paddingLeft:"$2",fontWeight:700,color:"$neutral-2"}},"Powered by Rollout")),Tt.default.createElement(vt.st.div,{css:{marginTop:"$2",fontSize:"8px",color:"$grayMedium"}},"By automating, you agree to Rollout's"," ",Tt.default.createElement(vt.st.a,{href:"https://docs.rollouthq.com/security-and-legal/security",css:{color:"black",textDecoration:"underline"}},"Terms")," ","&"," ",Tt.default.createElement(vt.st.a,{href:"https://docs.rollouthq.com/security-and-legal/privacy-policy",css:{color:"black",textDecoration:"underline"}},"Privacy policy")))}var Y=C(require("react"));function ce(o,t,r,n){Object.defineProperty(o,t,{get:r,set:n,enumerable:!0,configurable:!0})}var fe={};ce(fe,"SSRProvider",()=>ge);ce(fe,"useSSRSafeId",()=>wn);ce(fe,"useIsSSR",()=>On);var Ro={prefix:String(Math.round(Math.random()*1e10)),current:0},Vo=Y.default.createContext(Ro);function ge(o){let t=(0,Y.useContext)(Vo),r=(0,Y.useMemo)(()=>({prefix:t===Ro?"":`${t.prefix}-${++t.current}`,current:0}),[t]);return Y.default.createElement(Vo.Provider,{value:r},o.children)}var Tn=Boolean(typeof window<"u"&&window.document&&window.document.createElement);function wn(o){let t=(0,Y.useContext)(Vo);return t===Ro&&!Tn&&console.warn("When server rendering, you must wrap your application in an <SSRProvider> to ensure consistent ids are generated between the client and server."),(0,Y.useMemo)(()=>o||`react-aria${t.prefix}-${++t.current}`,[o])}function On(){let t=(0,Y.useContext)(Vo)!==Ro,[r,n]=(0,Y.useState)(t);return typeof window<"u"&&t&&(0,Y.useLayoutEffect)(()=>{n(!1)},[]),r}var Ot=require("@sentry/browser"),dt=C(require("react")),qr=require("react-error-boundary"),Zr=require("@rollouthq/api-client-react");var wt=C(require("react")),Rr=require("@rollouthq/ui"),zr=require("@rollouthq/ui");function Ur(){return wt.default.createElement("div",{className:"rollout-error-fallback__container"},wt.default.createElement("div",null,wt.default.createElement(Rr.Gear,{style:{width:"40px",height:"40px"}}),wt.default.createElement(zr.RedQuestion,{style:{position:"relative",right:"10px",bottom:"30px"}})),wt.default.createElement("div",{className:"rollout-error-fallback__text-container"},wt.default.createElement("div",{className:"rollout-error-fallback__message"},"An unexpected error occured"),wt.default.createElement("div",{className:"rollout-error-fallback__additional-info"},"Please try again later")))}var Wr="https://app.rollouthq.com/api",Nn="https://28e3dd4b02f14f2eb74768520edbc8a1@o345148.ingest.sentry.io/6463365";function Yr(o){let{token:t,allowedApps:r,apiBaseUrl:n=Wr,children:e,env:a="production",onError:i}=o,[s]=(0,dt.useState)(()=>new Ot.BrowserClient({dsn:Nn,transport:Ot.makeFetchTransport,stackParser:Ot.defaultStackParser,integrations:Ot.defaultIntegrations})),l=(0,dt.useCallback)((u,d)=>{i==null||i(u,d),a==="production"&&s.captureException(u,{data:{info:d}})},[a,s,i]);return dt.default.createElement(qr.ErrorBoundary,{FallbackComponent:Ur,onError:l},dt.default.createElement(Ne,{apiBaseUrl:n},dt.default.createElement(Qe,{allowedApps:r},dt.default.createElement(Zr.RolloutAPIClientProvider,{token:t,apiBaseUrl:n!=null?n:Wr},dt.default.createElement(tr,null,dt.default.createElement(ge,null,e))))))}var Xr=require("@rollouthq/common");var Hr=require("@rollouthq/ui"),zo={border:"1px solid #D5DCE2",borderRadius:"8px",padding:"16px",marginTop:"24px",background:"white"},Bn=(0,Hr.globalCss)({".rollout-automation-form__line-items-container":{border:"1px solid #DFE1E4",borderRadius:"8px"},".rollout-automation-form__line-items-header":{padding:"12px",display:"flex",gap:"12px",alignItems:"flex-start",flexDirection:"column",background:"linear-gradient(180deg, rgba(255, 255, 255, 0.03) 0%, rgba(0, 0, 0, 0.03) 100%), #FFFFFF"},".rollout-automation-form__line_items-description":{fontSize:"13px"},".rollout-automation-form__line-items-title":{fontSize:"13px",fontWeight:"600"},".rollout-automation-form__line-items-content":{padding:"16px",display:"flex",flexDirection:"column",gap:"16px"},".rollout-automations-list__container":{display:"flex",flexDirection:"column"},".rollout-automations-list__header":{display:"flex",paddingY:"16px",marginBottom:"16px",alignItems:"center",justifyContent:"space-between",borderBottom:"1px solid #EFF1F4"},".rollout-automations-list__header-title":{fontWeight:"600"},".rollout-error-fallback__container":{boxSizing:"border-box",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",padding:"32px",gap:"16px",margin:"24px auto",width:"572px",height:"173px",border:"1px solid #D5DCE2",borderRadius:"8px"},".rollout-error-fallback__text-container":{display:"flex",flexDirection:"column",alignItems:"center",gap:"4px",width:"227px",height:"48px"},".rollout-error-fallback__message":{color:"#6C6F75",fontFamily:"Inter",fontStyle:"normal",fontWeight:"600",fontSize:"16px",lineHeight:"150%"},".rollout-error-fallback__additional-info":{color:"#6C6F75",fontFamily:"Inter",fontStyle:"normal",fontweight:"500",fontSize:"13px",lineHeight:"150%"},".rollout-combobox__input__spinner":{width:"1rem",height:"1rem"},".rollout-combobox__input":{width:"100%",paddingX:"$2",paddingY:"$2-5",background:"none",outline:"none",border:"none",cursor:"text",paddingRight:"40px",fontSize:"13px","&:focus":{borderColor:"$interactPrimary"},"[data-disabled]":{opacity:.4,cursor:"not-allowed"},".rollout-combobox__input__left-element[data-icon] ~ &":{paddingLeft:"40px"},"&:disabled":{cursor:"not-allowed"}},".rollout-select__tag":{margin:"2px",paddingX:"6px",paddingY:"1px",height:"fit-content",display:"flex",alignItems:"center",gap:"4px",background:"white",border:"1px solid #EFF1F4",borderRadius:"4px",fontWeight:"500",cursor:"pointer",whiteSpace:"nowrap"},".rollout-select__tag-icon":{color:"#91959C","&:hover":{color:"black"}},".rollout-select__input":{background:"none",outline:"none",border:"none",width:"100%","&:disabled":{cursor:"not-allowed"}},".rollout-select__input__group":{background:"#F8F9FB",height:"36px",paddingX:"8px",".rollout-select__input":{paddingLeft:"0"}},".rollout-form-control__input[data-error]":{".rollout-combobox__input__group, .rollout-select__input__group, .rollout__base-input":{borderColor:"$error"}},".rollout-combobox__input__group, .rollout-select__input__group":{position:"relative",overflow:"hidden",display:"flex",alignItems:"center",fontSize:"13px",outline:"none",overflowX:"hidden",borderWidth:"1px",borderRadius:"$md",borderStyle:"solid",borderColor:"$strokeMedium","&[data-focused]":{borderColor:"$interactPrimary"},"&[data-disabled]":{cursor:"not-allowed",color:"$grayMedium",backgroundColor:"$surfaceSecondary"}},".rollout-connect-combobox__label, .rollout-connect-select__label":{marginBottom:"$2",span:{color:"$primary"}},".rollout-combobox__input__left-element, .rollout-combobox__input__right-element":{display:"flex",alignItems:"center",justifyContent:"center",position:"absolute","&:not([data-open])":{pointerEvents:"none"},"&[data-open]":{cursor:"pointer"},top:"50%",transform:"translateY(-50%)",zIndex:2,color:"#91959C",border:"none",background:"none"},".rollout-combobox__input__left-element":{size:"24px",left:"8px","&:not([data-icon])":{display:"none"},"[data-avatar][data-selected] &":{background:"transparent",border:"none",color:"white",fontSize:"$1"},borderWidth:"1px",borderColor:"#EFF1F4",borderStyle:"solid",borderRadius:"6px",background:"white"},".rollout-combobox__input__right-element, .rollout-select__input__right-element":{size:"16px",right:"8px"},".rollout-combobox__input__spinner, .rollout-select__input__spinner":{flexShrink:"0",size:"12px"},".rollout-combobox__content, .rollout-select__content":{maxHeight:"288px",overflowX:"hidden",overflowY:"auto",outline:"none",border:"solid 1px",borderColor:"#D5DCE2",borderRadius:"8px",".rollout-tab__list":{background:"#282A2F",padding:"10px 12px",fontSize:"13px",color:"white",fontWeight:"600",gap:"16px",border:"none"},".rollout-tabs__tab":{overflowX:"hidden !important",padding:"0",border:"none",color:"white",opacity:"0.4","&[data-selected]":{opacity:"1"}}},".rollout-select__multiple-alert":{display:"flex",alignItems:"center",gap:"8px",paddingX:"12px",paddingY:"8px",background:"#5386F6",color:"white",span:{fontSize:"13px",fontWeight:"500"}},".rollout-combobox__content ul":{margin:"0px",padding:"0px"},".rollout-select__content ul":{margin:"0px",padding:"0px"},".rollout-select__option-check__icon":{marginLeft:"auto"},".rollout-listbox":{width:"100%",margin:0,padding:0},".rollout-listbox__option, .rollout-select__option":{display:"flex",alignItems:"center",padding:"$2",fontSize:"$2",outline:"none",cursor:"pointer",borderBottom:"solid 1px",borderColor:"#F8F9FB","&[data-focused]":{background:"#F4F5F8"},"&[data-disabled]":{fontWeight:"500",color:"#91959C"},"&[data-selected]":{fontWeight:"500",color:"#5284F2",diaplay:"flex",alignItems:"center"}},".rollout-listbox__option-icon":{"[data-avatar] &":{background:"#C3C7CE;",color:"white",border:"none",borderRadius:"100%",padding:0,fontSize:"$1"},borderWidth:"1px",borderColor:"$strokeMedium",borderStyle:"solid",borderRadius:"$md",background:"white",size:"$6",padding:"$1",marginRight:"$1-5"},".rollout-automations-list__search-input":{paddingX:"40px",paddingY:"10px",borderRadius:"$md",outline:"none",borderWidth:"2px",borderColor:"#EFF1F4","&:focus":{borderColor:"$interactPrimary"},borderStyle:"solid",background:"#F8F9FB"},".rollout-automations-list__search-input__group":{position:"relative",display:"flex",marginBottom:"$4",color:"#91959C"},".rollout-automations-list__search-input__left-element":{position:"absolute",left:"0px",top:"0px",zIndex:2,display:"flex",size:"40px",fontSize:"$md",alignItems:"center",justifyContent:"center",pointerEvents:"none",svg:{size:"20px"}},".rollout-automations-list__not-found":{paddingInlineStart:"$4"},".rollout-form-control-find__container":{display:"flex",background:"#e0e1e4",width:"max-content",borderRadius:"6px"},".rollout-form-control-find__active":{color:"#5d88ef",fontSize:"0.8125rem",fontFamily:"inherit",fontWeight:"500",padding:"4px 36px",whiteSpace:"nowrap",background:"white",height:"32px",cursor:"pointer",borderRadius:"8px",border:"1px solid #e0e1e4"},".rollout-form-control-find__disabled":{color:"#6c6f75",fontFamily:"inherit",fontSize:"0.8125rem",fontWeight:"500",padding:"4px 36px",whiteSpace:"nowrap",background:"e0e0e5",height:"32px",cursor:"pointer",borderRadius:"8px"},".rollout-automations-list__new-btn":{display:"flex",alignItems:"center",gap:"8px",padding:"4px 12px",whiteSpace:"nowrap",backgroundColor:"#5386F7",color:"white",border:"none",borderRadius:"8px",height:"32px",cursor:"pointer"},".rollout-automations-list__empty-msg":{textAlign:"center",padding:"20px",border:"1px solid #eff1f4",borderRadius:"4px"},".rollout-automations-list__error-msg":{textAlign:"center",padding:"20px",border:"1px dashed #AA4849",borderRadius:"4px"},".rollout-automations-list__list":{display:"grid",gap:"16px",gridTemplateColumns:"repeat(auto-fill, minmax(250px, 1fr))"},".rollout-automations-list__item-wrapper":{position:"relative",marginBottom:"8px",maxWidth:"343px",border:"1px solid #D5DCE2",borderRadius:"8px","&:hover":{border:"1px solid #ADB4BA"},"&[data-deleting]":{opacity:.4},"&[data-deleting]::after":{content:"''",position:"absolute",inset:0,userSelect:"none",cursor:"wait"}},".rollout-automations-list__item":{padding:"16px",cursor:"pointer"},".rollout-automations-list-item__header":{display:"flex",alignItems:"center",justifyContent:"space-between"},".rollout-automations-list-item__draft-badge":{marginLeft:"auto",marginRight:"10px",padding:"4px 8px",borderRadius:"40px",background:"$neutral-4",fontSize:"small",color:"white"},".rollout-automations-list-item__icons":{display:"inline-flex",".rollout-automations-list-item__trigger, .rollout-automations-list-item__action":{padding:"$1",borderStyle:"solid",borderWidth:"1px",borderColor:"$strokeMedium",borderRadius:"$md",fontSize:"24px"},":first-child":{borderStartEndRadius:"unset",borderEndEndRadius:"unset",marginRight:"-1px"},":last-child":{borderStartStartRadius:"unset",borderEndStartRadius:"unset"},size:"fit-content"},".rollout-automations-list-item__name":{marginTop:"12px",fontSize:"16px",fontWeight:"600",color:"#31373F",height:"72px"},".rollout-automations-list-item__options__trigger":{display:"flex",justifyContent:"center",alignItems:"center",borderRadius:"4px",cursor:"pointer",color:"#91959C",transition:"all .2s ease",size:"32px",svg:{size:"16px"},"&:hover":{bg:"rgba(219, 97, 92, 0.1)",color:"#DB615C"},opacity:0,'[role="group"]:hover:not([data-open]) &':{opacity:1}},".rollout-automations-list-item__options__content":{position:"absolute",padding:"18px 16px",inset:"0",background:"white",borderRadius:"8px",display:"flex",flexDirection:"column",gap:"12px",justifyContent:"center",alignItems:"center",span:{fontWeight:"600"}},".rollout-automations-list-item__options__delete-item-btn":{background:"#DB615C",color:"white",whiteSpace:"nowrap","&:hover":{background:"#C74D48"},cursor:"pointer"},".rollout-automations-list-item__options__cancel-item-btn":{border:"1px solid #282A2F",cursor:"pointer"},".rollout-automations-manager__navbar":{paddingY:"$3"},".rollout-automations-manager__back-btn":{border:"none",background:"none"},".rollout-automation-form__header-back__arrow":{cursor:"pointer"},".rollout-automations-list-item__options__content button":{fonSize:"13px",fontWeight:"500",borderRadius:"8px",height:"32px",width:"100%",cursor:"pointer",transition:"all .2s ease"},".rollout-automation-form__name":{height:"36px",fontWeight:500,fontSize:"13px",background:"none",border:"1px solid",borderColor:"$strokeDark",borderRadius:"8px",paddingX:"$4",paddingY:"$2-5",outline:"none","&[aria-invalid]::placeholder":{color:"$error"}},".rollout-automation-form__action-inputs-wrapper, .rollout-automation-form__trigger-inputs-wrapper":{display:"flex",flexDirection:"column",gap:"$3"},".rollout-automation-form__trigger":f({},zo),".rollout-automation-form__trigger-inputs":f({},zo),".rollout-automation-form__action":f({},zo),".rollout-automation-form__action-inputs":f({},zo),".rollout-automation-form__trigger-trigger":{marginBottom:"$3"},".rollout-automation-form__trigger .rollout-automation-form__trigger-app ":{marginBottom:"$3"},".rollout-automation-form__trigger .rollout-automation-form__credentials":{marginTop:"$3"},".rollout-automation-form__action .rollout-automation-form__action-app":{marginBottom:"$3"},".rollout-automation-form__action .rollout-automation-form__action-action":{marginBottom:"$3"},".rollout-automation-form__credential":{marginBottom:"$3"},".rollout-automation-form__label":{fontWeight:"600",marginBottom:"12px"},".rollout-automation-form__helper-text":{marginBottom:"12px"},".rollout-automation-form__content":{marginBottom:"16px"},".rollout-automation-form-oauth__error__message":{marginTop:"4px",fontSize:"$2",color:"$error"},".rollout-input":{height:"36px",paddingX:"$2",paddingY:"$2-5",border:"1px solid",borderColor:"$strokeMedium",borderRadius:"6px"},".rollout-button--primary, .rollout-button--secondary, .rollout-button--danger":{display:"flex",justifyContent:"center",alignItems:"center",gap:"8px",height:"32px",padding:"4px 12px",fontWeight:600,whiteSpace:"nowrap",textAlign:"center",border:"1px solid",borderRadius:"8px"},".rollout-button--primary":{backgroundColor:"#5386F7",borderColor:"#5386F7",color:"white"},".rollout-button--secondary":{backgroundColor:"$grayMedium",borderColor:"$grayMedium",color:"white"},".rollout-button--danger":{color:"white",backgroundColor:"$error",borderColor:"$error","&:hover":{backgroundColor:"#A92F2A",borderColor:"#A92F2A"}},".rollout-automation-form__buttons":{display:"flex",gap:"$3"},".rollout-automation-form__cancel":{marginLeft:"auto"},".rollout-automation-form__delete":{position:"relative",marginLeft:"auto",".rollout-automation-form__cancel ~ &":{marginLeft:"0"}},".rollout-automation-form-delete__confirm-dialog":{position:"absolute",bottom:"100%",right:"0",whiteSpace:"nowrap",background:"white",marginBottom:"12px",padding:"12px",border:"1px solid #F8F9FB",borderRadius:"8px",boxShadow:"0px 4px 16px rgba(0, 0, 0, 0.2)"},".rollout-automation-form__delete-confirm-text":{padding:"$3",fontSize:"$2",fontWeight:500},".rollout-automation-form__delete-confirm-buttons":{display:"flex",justifyContent:"space-between",gap:"$3",marginTop:"$4"},".rollout-automation-form__delete-cancel, .rollout-automation-form__delete-confirm":{width:"100%"},".rollout-automation-form__submit[disabled], .rollout-automation-form__submit[data-loading]":{opacity:.3},".rollout-form-control__label":{marginBottom:"8px",fontSize:"$2",fontWeight:500,display:"flex",alignItems:"center"},".rollout-form-control__lock-btn":{marginLeft:"auto",display:"flex",justifyContent:"center",alignItems:"center",border:"1px solid #EFF1F4",size:"20px",cursor:"pointer",borderRadius:"4px",boxShadow:"$md",color:"#91959C",transition:"all .2s ease","&[data-locked]":{color:"#9A58F6"},"&:hover":{background:"#F8F9FB"},svg:{height:"14px"}},".rollout-form-control__required-hint":{paddingLeft:"4px",color:"$primary"},".rollout-form-control__description":{marginBottom:"8px",fontSize:"13px"},".rollout-form-control__error":{marginTop:"4px",fontSize:"$2",color:"$error"},".rollout-automation-form__api-token-input":{height:"32px",marginTop:"$2",marginBottom:"$4",background:"#F8F9FB",border:"1px solid #EFF1F4",borderRadius:"4px",paddingX:"8px","&:focus":{background:"white"}},".rollout-automation-form__api-token-input-info":{fontSize:"0.75rem",marginBottom:"$1-5",color:"#6C6F75"},".rollout-automation-form__api-token-input-label":{fontSize:"$2",marginTop:"$1-5"},".rollout-automation-form__api-token-input-container":{marginTop:"$2"},".rollout-automation-form__api-token-connection-result":{fontSize:".85rem"},".rollout-automation-form__api-token-apitoken-button-container":{display:"flex",justifyContent:"flex-start",alignItems:"center",gap:"$2-5"},".rollout-blueprint-activator__header":{display:"flex",alignItems:"center",borderBottom:"1px solid",borderBottomColor:"$strokeMedium",paddingY:"12px"},".rollout-blueprint-activator__name":{marginLeft:"16px"},".rollout-blueprint-activator__label":{padding:"12px",fontSize:"$3",fontWeight:"bold",borderBottom:"1px solid",borderBottomColor:"$strokeMedium"},".rollout-blueprint-activator__trigger":{marginTop:"12px",border:"1px solid",borderColor:"$strokeMedium",borderRadius:"8px","& .rollout-automation-form__credentials":{marginBottom:"$3"}},".rollout-blueprint-activator__trigger__fields":{padding:"12px"},".rollout-blueprint-activator__activate-btn, .rollout-blueprint-activator__deactivate-btn":{marginTop:"12px"},".rollout__loading_spinner_container":{padding:"1rem",display:"flex",justifyContent:"center"},".rollout__loading_spinner":{height:"1rem",width:"1rem"},".rollout__base-input":{background:"#F8F9FB",border:"1px solid #EFF1F4",borderRadius:"4px",paddingX:"8px","&:focus":{background:"white"}},"input.rollout__base-input, select.rollout__base-input":{height:"32px"},".rollout__terms-of-service-link, .rollout__privacy-policy-link":{color:"#31373F",textDecoration:"underline","&:hover":{color:"#1e2227"}},".ace_editor":{backgroundColor:"$surfaceSecondary"},".rollout-card":{display:"flex",flexDirection:"column",gap:"12px",marginTop:"12px",padding:"16px",border:"1px solid #d5dce2",borderRadius:"8px"}});0&&(module.exports={AutomationCreator,AutomationEditor,AutomationsManager,BlueprintActivator,BlueprintsList,BlueprintsManager,MyAutomations,MyBlueprints,PoweredByRollout,RolloutConnectProvider,components,curlyTemplate,defaultTheme});
//# sourceMappingURL=index.js.map